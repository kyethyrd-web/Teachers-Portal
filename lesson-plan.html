<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Lesson Plan</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  display: flex;
}

/* ===== SIDEBAR ===== */
.sidebar {
  width: 220px;
  background: #1e3a8a;
  color: white;
  height: 100vh;
  padding-top: 20px;
  transition: 0.3s;
}

.sidebar.collapsed {
  width: 70px;
}

.sidebar button {
  background: none;
  border: none;
  color: white;
  padding: 15px;
  text-align: left;
  width: 100%;
  cursor: pointer;
  font-size: 16px;
}

.sidebar button:hover {
  background: #3749a6;
}

.toggle-btn {
  font-size: 20px;
  text-align: center;
}

/* ===== MAIN ===== */
.main {
  flex: 1;
  padding: 20px;
}

.week-picker {
  width: 220px;
  padding: 5px;
  margin-bottom: 10px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

td {
  border: 1px solid black;
  padding: 6px;
  vertical-align: top;
}

.label {
  width: 200px;
  font-weight: bold;
}

.indent1 { padding-left: 20px; }
.indent2 { padding-left: 40px; }

input, textarea {
  width: 100%;
  border: none;
  outline: none;
  font-family: Arial;
}

textarea {
  resize: vertical;
}

.header-center {
  text-align: center;
}

.export-btn, .save-btn {
  margin-top: 15px;
  padding: 8px 15px;
  background: #1e3a8a;
  color: white;
  border: none;
  cursor: pointer;
}

.export-btn:hover, .save-btn:hover {
  background: #3749a6;
}
</style>
</head>

<body>

<div class="sidebar" id="sidebar">
  <button class="toggle-btn" onclick="toggleSidebar()">☰</button>
  <button onclick="window.location='profile.html'">Profile</button>
  <button onclick="window.location='dashboard.html'">Home</button>
</div>

<div class="main">

<h3>Select Any Date (Auto Generates Week)</h3>
<input type="date" class="week-picker" onchange="generateWeek(this.value)">

<div id="documentArea">

<div class="header-center">
  <h3>DETAILED LESSON PLAN</h3>
  <p>School: <input id="school"></p>
  <p>Teacher: <input id="teacher"></p>
  <p>Grade Level: <input id="grade"></p>
  <p>Subject: <input id="subject"></p>
  <p>Week: <span id="weekRange"></span></p>
  <p>Time: <input id="time"></p>
</div>

<table>
<tr>
  <td class="label">I. OBJECTIVES</td>
  <td></td>
</tr>
<tr>
  <td class="label indent1">A. Content Standard</td>
  <td><textarea id="contentStandard"></textarea></td>
</tr>
<tr>
  <td class="label indent1">B. Performance Standard</td>
  <td><textarea id="performanceStandard"></textarea></td>
</tr>
<tr>
  <td class="label indent1">C. Learning Competencies</td>
  <td><textarea id="competencies"></textarea></td>
</tr>

<tr>
  <td class="label">II. CONTENT</td>
  <td><textarea id="content"></textarea></td>
</tr>

<tr>
  <td class="label">III. LEARNING RESOURCES</td>
  <td></td>
</tr>
<tr>
  <td class="label indent1">A. References</td>
  <td><textarea id="references"></textarea></td>
</tr>
<tr>
  <td class="label indent1">B. Other Resources</td>
  <td><textarea id="otherResources"></textarea></td>
</tr>

<tr>
  <td class="label">IV. PROCEDURE</td>
  <td><textarea id="procedure"></textarea></td>
</tr>

<tr>
  <td class="label">V. REMARKS</td>
  <td><textarea id="remarks"></textarea></td>
</tr>

<tr>
  <td class="label">VI. REFLECTION</td>
  <td><textarea id="reflection"></textarea></td>
</tr>

</table>

</div>

<button class="save-btn" onclick="saveData()">Save</button>
<button class="export-btn" onclick="exportToWord()">Export to Word</button>

</div>

<script>

/* ===== SIDEBAR ===== */
function toggleSidebar() {
  document.getElementById("sidebar").classList.toggle("collapsed");
}

/* ===== WEEK GENERATOR ===== */
function generateWeek(dateStr) {
  let date = new Date(dateStr);
  let day = date.getDay();
  let monday = new Date(date);
  monday.setDate(date.getDate() - (day === 0 ? 6 : day - 1));
  let friday = new Date(monday);
  friday.setDate(monday.getDate() + 4);

  const options = { month: 'long', day: '2-digit', year: 'numeric' };

  let formatted =
    monday.toLocaleDateString('en-US', options) +
    " – " +
    friday.toLocaleDateString('en-US', options);

  document.getElementById("weekRange").innerText = formatted;
}

/* ===== SAVE SAFELY ===== */
function saveData() {
  const data = {
    school: school.value,
    teacher: teacher.value,
    grade: grade.value,
    subject: subject.value,
    week: weekRange.innerText,
    time: time.value,
    contentStandard: contentStandard.value,
    performanceStandard: performanceStandard.value,
    competencies: competencies.value,
    content: content.value,
    references: references.value,
    otherResources: otherResources.value,
    procedure: procedure.value,
    remarks: remarks.value,
    reflection: reflection.value
  };

  localStorage.setItem("lessonPlan", JSON.stringify(data));
  alert("Saved successfully!");
}

/* ===== EXPORT TO WORD ===== */
function exportToWord() {

  let content = document.getElementById("documentArea").innerHTML;

  let header = `
  <html xmlns:o='urn:schemas-microsoft-com:office:office'
  xmlns:w='urn:schemas-microsoft-com:office:word'
  xmlns='http://www.w3.org/TR/REC-html40'>
  <head><meta charset='utf-8'></head><body>`;

  let footer = "</body></html>";

  let sourceHTML = header + content + footer;

  let blob = new Blob(['\ufeff', sourceHTML], {
    type: 'application/msword'
  });

  let url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);

  let downloadLink = document.createElement("a");
  document.body.appendChild(downloadLink);

  downloadLink.href = url;
  downloadLink.download = "Detailed_Lesson_Plan.doc";
  downloadLink.click();

  document.body.removeChild(downloadLink);
}

</script>

</body>
</html>
